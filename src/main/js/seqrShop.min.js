window.console||(window.console={log:function(m){}});
(function(){function m(a,e){try{var b=h[a];if(!b){var c="var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g,"',$1,'").split("<%").join("');").split("%>").join("p.push('")+"');}return p.join('');",b=new Function("obj",c);h[a]=b}return b(e)}catch(f){return"< % ERROR: "+f.message+" % >"}}function k(a,b,d){var c;c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");
c.onreadystatechange=function(){4==c.readyState&&200==c.status&&b(c.responseText);4==c.readyState&&400<=c.status&&d&&d(a,c.status)};c.open("GET",a,!0);c.send()}function q(){var a=document.getElementById("seqrShop").src;f=a.substring(0,a.indexOf("/js/seqrShop.js"));b.baseURL=f;var a=a.slice(a.indexOf("#!")+2).split("&"),e;for(e in a){var d=a[e].split("=");2==d.length&&(b[d[0]]=d[1])}}function r(){var a=navigator.language||navigator.userLanguage,a=a.replace(/_/,"-").toLowerCase();return a.split("-")[0]}
function g(a,e){return b.hasOwnProperty(a)?b[a]:e}function p(a,b){for(var d=document.getElementsByClassName(a),c=0;c!=d.length;++c)d[c].style.visibility=b?"visible":"hidden"}function n(){b.hasOwnProperty("apiURL")&&b.hasOwnProperty("invoiceId")&&k(b.apiURL+"/invoices/"+b.invoiceId,function(a){a=JSON.parse(a);a.status&&b.SEQR_STATUS!=a.status&&(b.SEQR_STATUS=a.status,p("SEQR_STATUS",!1),p("SEQR_STATUS_"+a.status,!0));if("PAID"==a.status){if(b.hasOwnProperty("successCallback")){var e=g("successCallback");
if(window.hasOwnProperty(e))window[e](a);else console.log(e+" is undefined.")}b.hasOwnProperty("successURL")&&(document.location=g("successURL"))}else window.setTimeout(n,1E3)},function(a,b){404==b?console.log(b+" loading "+a+", giving up."):(console.log(b+" loading "+a+", retrying."),window.setTimeout(n,3E3))})}var f="",b={},h={},l={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},
Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)}};(function(){q();var a=g("platform",l.Android()||l.iOS()?"mobile":l.BlackBerry()||l.Opera()||l.Windows()?"unsupported":"desktop"),e=g("language",r()),d=g("layout","standard"),c=g("apiURL","http://extdev4.seqr.se/merchant/api");b.platform=a;b.language=e;b.layout=d;b.apiURL=c;b.SEQR_STATUS="INIT";k(f+"/css/"+d+"_"+a+".css",function(a){a=m(a,b);var c=document.createElement("style");
c.type="text/css";c.styleSheet?c.styleSheet.cssText=a:c.innerHTML=a;document.getElementsByTagName("head")[0].appendChild(c)});var h=function(c){var e=JSON.parse(c);k(f+"/templates/"+d+"_"+a+".html",function(a){var c=b,d={},f;for(f in c)d[f]=c[f];for(var g in e)d[g]=e[g];a=m(a,d);document.getElementById("seqrShop").outerHTML=a;n()})};k(f+"/lang/"+e+".json",h,function(a,b){console.log(b+" loading"+a+", reverting to default language.");k(f+"/lang/en.json",h)})})()}).call();
